# ECSの構築

## Elastic Compute Service(ECS)
Alibaba Cloud上の仮想的なサーバーです。CPU・メモリ・ディスク・通信速度等のスペックを自由に選択できます。スペックに比例した1時間ごとの従量課金と月額サブスクリプション料金体系があります。セキュリティグループと呼ばれるファイアウォールを使用できます。

![ECS](img/ecs.png)

## セキュリティグループの作成
1. *仮想サーバー* メニューの *Elastic Compute Service* を選択します
1. 左上のリージョンから指定されたリージョンを選択します
1. 左のメニューから *セキュリティグループ* を選択します
1. 右上の *セキュリティグループの作成* をボタンを押下します
1. 次の通り入力します
  * *テンプレート* : `カスタマイズ`
  * *セキュリティグループ名* : `sg-imagesearchhandson`
  * *セキュリティグループタイプ* : `ベーシックセキュリティグループ`
  * *ネットワークタイプ* : `VPC`
  * *VPC* : `vpc-imagesearchhandson`
1. *OK* ボタンを押下します
1. *ルールをすぐに設定* ボタンを押下します
1. **jupyter notebook用**
  1. 右上の *セキュリティグループルールを追加* ボタンを押下します
  1. 次の通り入力します
      * *ルールの方向* : `受信`
      * *権限付与ポリシー* : `許可`
      * *プロトコルタイプ* : `Custom TCP`
      * *ポート範囲* : `8888`
      * *プライオリティ* : `1`
      * *権限付与タイプ* : `IPv4 CIDR ブロック`
      * *権限付与オブジェクト* : `0.0.0.0/0`
    1. *OK* ボタンを押下します
1. **SSH用**
  1. 右上の *セキュリティグループルールを追加* ボタンを押下します
  1. 次の通り入力します
      * *ルールの方向* : `受信`
      * *権限付与ポリシー* : `許可`
      * *プロトコルタイプ* : `SSH(22)`
      * *プライオリティ* : `1`
      * *権限付与タイプ* : `IPv4 CIDR ブロック`
      * *権限付与オブジェクト* : `0.0.0.0/0`
  1. *OK* ボタンを押下します

## ECSの構築
1. *仮想サーバー* メニューの *Elastic Compute Service* を選択します
1. 左上のリージョンから指定されたリージョンを選択します
1. 左のメニューから *インスタンス* を選択します
1. 右上の *インスタンスを作成* ボタンを押下します
1. 次の通り入力します
  * *価格モデル* : `従量課金`
  * *リージョン*
    * *中国（香港）* : `Hong Kong Zone B`
    * *シンガポール* : `Singapore Zone A`
    * *オーストラリア（シドニー）* : `Sydney Zone A`
    * *日本（東京）* : `Tokyo Zone A`
  * *インスタンスタイプ*
    * *vCPU* : `1vCPU`
    * *メモリ* : `0.5GiB`
    * *1 vCPU 0.5 GiB* : `バースト可能タイプ t5`
    * *インスタンス数* : `1`
  * *イメージ*
    * *共有イメージ* : `AliEatersCodeBranch-3-20191207`
  * *ストレージ*
    * *Ultra ディスク* : `20GiB`
1. *次のステップ: ネットワーク* ボタンを押下します
1. 次の通り入力します
  * *ネットワーク*
    * *VPC* : `vpc-imagesearchhandson`
    * *VSwitch* : `vswitch-imagesearchhandson`
  * *ネットワーク課金タイプ*
    * *パブリック IP の割り当て* : **チェックをつける**
    * *帯域幅の料金* : `1Mbps`
  * *セキュリティグループ*
    1. *セキュリティグループの再選択* を選択します
      * `sg-imagesearchhandson` :  **選択する**
    1. *選択* ボタンを押下します
1. *次のステップ: システム構成* ボタンを押下します
1. 次の通り入力します
    * *ログイン認証* : `パスワード`
    * *パスワード* : `任意の文字列`
    * *パスワードの確認* : `任意の文字`
    * *インスタンス名* : `ecs-imagesearchhandson`
    * *ホスト* : `imagesearchhandson`
1. *次のステップ: グループ化* ボタンを押下します
1. *次のステップ: プレビュー* ボタンを押下します
  1. 次の通り入力します
    * *利用規約* : **チェックをつける**
1. *インスタンスの作成* ボタンを押下します
1. *コンソール* ボタンを押下します

## 参考
- [ECS公式ドキュメント](https://jp.alibabacloud.com/product/ecs)

[戻る](Step5.md) | [次へ](Step6.md)
